{"filter":false,"title":"Authorization.php","tooltip":"/Authorization.php","undoManager":{"mark":83,"position":83,"stack":[[{"start":{"row":0,"column":0},"end":{"row":124,"column":2},"action":"remove","lines":["<?php","","","","class Connection","{","","var $url_const_first = 'https://oauth.vk.com/authorize?';","var $url_const_second = 'https://oauth.vk.com/access_token?';","var $redirect_url = 'https://localhost/test/info/view1';","var $start_params;","var $second_params;","var $code;","var $token;","var $user_id;","","function __construct ($app_id, $app_secrets, $mask)","\t{","\t\t","\t\t$this->start_params = \t\t","\t\t[","\t\t'client_id'=>$app_id,","\t\t'redirect_uri'=>$this->redirect_url,","\t\t'display'=>'page',","\t\t'skope' =>$mask,","\t\t'response_type'=>'code',","\t\t'v'=>5.63","\t\t];","\t\t","\t\t$this->second_params = ","\t\t[","\t\t'client_id'=>$app_id,","\t\t'client_secret'=>$app_secrets,","\t\t'redirect_uri'=>'https://localhost/test/info/view1',","\t\t'code'=>$this->code","\t\t];\t\t\t\t","\t}","","","\tfunction get_start_connect ()","\t\t{","\t\t\treturn $this->url_const_first.'client_id='.$this->start_params['client_id'].'&redirect_uri='.$this->redirect_url.'&display='.$this->start_params['display'].'&scope='.$this->start_params['skope'].'&response_type='.$this->start_params['response_type'].'&v='.$this->start_params['v'];","\t\t}","","\tfunction get_token_connect ()","\t\t{","\t\t\treturn $this->url_const_second.'client_id='.$this->second_params['client_id'].'&client_secret='.$this->second_params['client_secret'].'&redirect_uri='.$this->second_params['redirect_uri'].'&code='.$this->second_params['code'];","\t\t}","","\tpublic function get_code ()","\t{\t","\t\t//$ch = curl_init();","\t\t//curl_setopt($ch, CURLOPT_URL, $this->get_start_connect());","\t\t//curl_setopt($ch, CURLOPT_HEADER, 1);","\t\t//curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);","\t\t//curl_setopt($ch, CURLOPT_FOLLOWLOCATION,1);\t","\t\t//curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 30);","\t\t//curl_setopt($ch, CURLOPT_SSL_VERIFYPEER,1);\t","\t\t//curl_exec($ch);","\t\t//curl_close($ch); ","\t\theader('HTTP/1.1 301 Moved Permanently');","\t\theader(\"LOCATION:\".$this->get_start_connect());","\t}","\t","","\t","\tpublic function set_code ($code)","\t{","\t\t$this->second_params['code'] = $code;\t\t","\t}","\t","\tpublic function set_token ($token)","\t{","\t\t$this->token = $token;","\t}","\t","\tpublic function get_token_true()","\t{","\t\treturn $this->token;","\t}","\t","\tpublic function get_token ()","\t{","\t\t","\t\techo $this->get_start_connect();","\t $curl = curl_init();","\t curl_setopt ($curl,CURLOPT_URL, $this->get_token_connect());","\t curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1);","\t curl_setopt($curl, CURLOPT_FOLLOWLOCATION, 1);","\t curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, false);","\t curl_setopt($curl, CURLOPT_SSL_VERIFYHOST, false);","\t curl_setopt($curl, CURLOPT_HEADER, 0);","\t $result = curl_exec($curl);","\t curl_close($curl);","\t ","","\t if (isset($result))","\t {","\t\t $p = JSON_decode($result);","\t\t print_r($p);","\t\t $this->token=$p->access_token; //тут потом надо вносить данные в базу","\t\t $this->user_id = $p->user_id;","\t\t return true;","\t }","\t else","\t\t return false;","\t","\t","\t}","\t","}","","","","","","","","","","","","","","?>"],"id":2},{"start":{"row":0,"column":0},"end":{"row":38,"column":0},"action":"insert","lines":["<?php","","class config{","","","static $app_id = '5944941';","static $secret_key = 'vXuvd4TNRMze7rWQbY2V';","static $params_code = array(","'client_id' => '5944941',"," 'display' => 'page',"," 'redirect_uri' => 'http://localhost/site/index.php',"," 'scope' => 'friends,groups',"," 'response_type' => 'code',"," 'v' => '5.63'",");","","static $get_access_code_url = 'http://oauth.vk.com/authorize?';","static $get_access_token_url = 'https://oauth.vk.com/access_token?';","","function GetToken() {","$params = array(","'client_id' => config::$app_id,"," 'client_secret' => config::$secret_key,"," 'redirect_uri' => 'http://localhost/site/index.php',"," 'code' => $_SESSION['code']",");","$url = 'https://oauth.vk.com/access_token?' . http_build_query($params);","$ch = curl_init();","curl_setopt($ch, CURLOPT_URL, $url);","curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 0);","curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, 0);","curl_setopt($ch, CURLOPT_HEADER, false);","curl_setopt($ch, CURLOPT_RETURNTRANSFER, TRUE);","$token = json_decode(curl_exec($ch));","curl_close($ch);","return $token;","}","}",""]}],[{"start":{"row":5,"column":18},"end":{"row":5,"column":25},"action":"remove","lines":["5944941"],"id":3},{"start":{"row":5,"column":18},"end":{"row":5,"column":25},"action":"insert","lines":["5906561"]}],[{"start":{"row":6,"column":22},"end":{"row":6,"column":42},"action":"remove","lines":["vXuvd4TNRMze7rWQbY2V"],"id":4},{"start":{"row":6,"column":22},"end":{"row":6,"column":42},"action":"insert","lines":["6Wk8wfl0BAbkHpx7oNXv"]}],[{"start":{"row":10,"column":20},"end":{"row":10,"column":41},"action":"remove","lines":["http://localhost/site"],"id":5}],[{"start":{"row":23,"column":20},"end":{"row":23,"column":42},"action":"remove","lines":["http://localhost/site/"],"id":6}],[{"start":{"row":23,"column":20},"end":{"row":23,"column":21},"action":"insert","lines":["/"],"id":7}],[{"start":{"row":11,"column":26},"end":{"row":11,"column":27},"action":"remove","lines":["s"],"id":8}],[{"start":{"row":11,"column":25},"end":{"row":11,"column":26},"action":"remove","lines":["p"],"id":9}],[{"start":{"row":11,"column":24},"end":{"row":11,"column":25},"action":"remove","lines":["u"],"id":10}],[{"start":{"row":11,"column":23},"end":{"row":11,"column":24},"action":"remove","lines":["o"],"id":11}],[{"start":{"row":11,"column":22},"end":{"row":11,"column":23},"action":"remove","lines":["r"],"id":12}],[{"start":{"row":11,"column":21},"end":{"row":11,"column":22},"action":"remove","lines":["g"],"id":13}],[{"start":{"row":11,"column":21},"end":{"row":11,"column":28},"action":"insert","lines":["photos "],"id":14}],[{"start":{"row":11,"column":27},"end":{"row":11,"column":28},"action":"remove","lines":[" "],"id":15}],[{"start":{"row":23,"column":20},"end":{"row":23,"column":21},"action":"remove","lines":["/"],"id":16}],[{"start":{"row":23,"column":20},"end":{"row":23,"column":54},"action":"insert","lines":["https://apivk-bekrenev.c9users.io/"],"id":17}],[{"start":{"row":23,"column":54},"end":{"row":23,"column":55},"action":"insert","lines":["/"],"id":18}],[{"start":{"row":23,"column":54},"end":{"row":23,"column":55},"action":"remove","lines":["/"],"id":19}],[{"start":{"row":23,"column":27},"end":{"row":23,"column":28},"action":"remove","lines":["/"],"id":20}],[{"start":{"row":23,"column":26},"end":{"row":23,"column":27},"action":"remove","lines":["/"],"id":21}],[{"start":{"row":23,"column":25},"end":{"row":23,"column":26},"action":"remove","lines":[":"],"id":22}],[{"start":{"row":23,"column":24},"end":{"row":23,"column":25},"action":"remove","lines":["s"],"id":23}],[{"start":{"row":23,"column":23},"end":{"row":23,"column":24},"action":"remove","lines":["p"],"id":24}],[{"start":{"row":23,"column":22},"end":{"row":23,"column":23},"action":"remove","lines":["t"],"id":25}],[{"start":{"row":23,"column":21},"end":{"row":23,"column":22},"action":"remove","lines":["t"],"id":26}],[{"start":{"row":23,"column":20},"end":{"row":23,"column":21},"action":"remove","lines":["h"],"id":27}],[{"start":{"row":10,"column":20},"end":{"row":10,"column":30},"action":"remove","lines":["/index.php"],"id":28},{"start":{"row":10,"column":20},"end":{"row":10,"column":55},"action":"insert","lines":["apivk-bekrenev.c9users.io/index.php"]}],[{"start":{"row":10,"column":20},"end":{"row":10,"column":21},"action":"insert","lines":["h"],"id":29}],[{"start":{"row":10,"column":21},"end":{"row":10,"column":22},"action":"insert","lines":["t"],"id":30}],[{"start":{"row":10,"column":22},"end":{"row":10,"column":23},"action":"insert","lines":["t"],"id":31}],[{"start":{"row":10,"column":23},"end":{"row":10,"column":24},"action":"insert","lines":["p"],"id":32}],[{"start":{"row":10,"column":24},"end":{"row":10,"column":25},"action":"insert","lines":["s"],"id":33}],[{"start":{"row":10,"column":25},"end":{"row":10,"column":26},"action":"insert","lines":["/"],"id":34}],[{"start":{"row":10,"column":25},"end":{"row":10,"column":26},"action":"insert","lines":[":"],"id":35}],[{"start":{"row":10,"column":26},"end":{"row":10,"column":27},"action":"insert","lines":["/"],"id":36}],[{"start":{"row":10,"column":62},"end":{"row":10,"column":63},"action":"remove","lines":["p"],"id":37}],[{"start":{"row":10,"column":61},"end":{"row":10,"column":62},"action":"remove","lines":["h"],"id":38}],[{"start":{"row":10,"column":60},"end":{"row":10,"column":61},"action":"remove","lines":["p"],"id":39}],[{"start":{"row":10,"column":59},"end":{"row":10,"column":60},"action":"remove","lines":["."],"id":40}],[{"start":{"row":10,"column":58},"end":{"row":10,"column":59},"action":"remove","lines":["x"],"id":41}],[{"start":{"row":10,"column":57},"end":{"row":10,"column":58},"action":"remove","lines":["e"],"id":42}],[{"start":{"row":10,"column":56},"end":{"row":10,"column":57},"action":"remove","lines":["d"],"id":43}],[{"start":{"row":10,"column":55},"end":{"row":10,"column":56},"action":"remove","lines":["n"],"id":44}],[{"start":{"row":10,"column":54},"end":{"row":10,"column":55},"action":"remove","lines":["i"],"id":45}],[{"start":{"row":10,"column":53},"end":{"row":10,"column":54},"action":"remove","lines":["/"],"id":46}],[{"start":{"row":23,"column":20},"end":{"row":23,"column":55},"action":"remove","lines":["apivk-bekrenev.c9users.io/index.php"],"id":47},{"start":{"row":23,"column":20},"end":{"row":23,"column":53},"action":"insert","lines":["https://apivk-bekrenev.c9users.io"]}],[{"start":{"row":10,"column":53},"end":{"row":10,"column":54},"action":"insert","lines":["/"],"id":48}],[{"start":{"row":23,"column":53},"end":{"row":23,"column":54},"action":"insert","lines":["/"],"id":49}],[{"start":{"row":8,"column":16},"end":{"row":8,"column":23},"action":"remove","lines":["5944941"],"id":50},{"start":{"row":8,"column":16},"end":{"row":8,"column":23},"action":"insert","lines":["5906561"]}],[{"start":{"row":2,"column":6},"end":{"row":2,"column":12},"action":"remove","lines":["config"],"id":51},{"start":{"row":2,"column":6},"end":{"row":2,"column":7},"action":"insert","lines":["a"]}],[{"start":{"row":2,"column":7},"end":{"row":2,"column":8},"action":"insert","lines":["u"],"id":52}],[{"start":{"row":2,"column":8},"end":{"row":2,"column":9},"action":"insert","lines":["t"],"id":53}],[{"start":{"row":2,"column":9},"end":{"row":2,"column":10},"action":"insert","lines":["h"],"id":54}],[{"start":{"row":21,"column":15},"end":{"row":21,"column":21},"action":"remove","lines":["config"],"id":55},{"start":{"row":21,"column":15},"end":{"row":21,"column":16},"action":"insert","lines":["a"]}],[{"start":{"row":21,"column":16},"end":{"row":21,"column":17},"action":"insert","lines":["u"],"id":56}],[{"start":{"row":21,"column":15},"end":{"row":21,"column":17},"action":"remove","lines":["au"],"id":57},{"start":{"row":21,"column":15},"end":{"row":21,"column":19},"action":"insert","lines":["auth"]}],[{"start":{"row":22,"column":20},"end":{"row":22,"column":26},"action":"remove","lines":["config"],"id":58},{"start":{"row":22,"column":20},"end":{"row":22,"column":21},"action":"insert","lines":["a"]}],[{"start":{"row":22,"column":21},"end":{"row":22,"column":22},"action":"insert","lines":["u"],"id":59}],[{"start":{"row":22,"column":22},"end":{"row":22,"column":23},"action":"insert","lines":["t"],"id":60}],[{"start":{"row":22,"column":23},"end":{"row":22,"column":24},"action":"insert","lines":["h"],"id":61}],[{"start":{"row":19,"column":21},"end":{"row":20,"column":0},"action":"insert","lines":["",""],"id":62},{"start":{"row":20,"column":0},"end":{"row":20,"column":1},"action":"insert","lines":["\t"]}],[{"start":{"row":20,"column":1},"end":{"row":20,"column":2},"action":"insert","lines":["v"],"id":63}],[{"start":{"row":20,"column":2},"end":{"row":20,"column":3},"action":"insert","lines":["a"],"id":64}],[{"start":{"row":20,"column":3},"end":{"row":20,"column":4},"action":"insert","lines":["r"],"id":65}],[{"start":{"row":20,"column":3},"end":{"row":20,"column":4},"action":"remove","lines":["r"],"id":66}],[{"start":{"row":20,"column":2},"end":{"row":20,"column":3},"action":"remove","lines":["a"],"id":67}],[{"start":{"row":20,"column":1},"end":{"row":20,"column":2},"action":"remove","lines":["v"],"id":68}],[{"start":{"row":20,"column":0},"end":{"row":20,"column":1},"action":"remove","lines":["\t"],"id":69}],[{"start":{"row":20,"column":0},"end":{"row":20,"column":1},"action":"insert","lines":["v"],"id":70}],[{"start":{"row":20,"column":1},"end":{"row":20,"column":2},"action":"insert","lines":["a"],"id":71}],[{"start":{"row":20,"column":2},"end":{"row":20,"column":3},"action":"insert","lines":["r"],"id":72}],[{"start":{"row":20,"column":3},"end":{"row":20,"column":4},"action":"insert","lines":["_"],"id":73}],[{"start":{"row":20,"column":0},"end":{"row":20,"column":4},"action":"remove","lines":["var_"],"id":74},{"start":{"row":20,"column":0},"end":{"row":20,"column":10},"action":"insert","lines":["var_dump()"]}],[{"start":{"row":20,"column":9},"end":{"row":20,"column":26},"action":"insert","lines":["$_SESSION['code']"],"id":75}],[{"start":{"row":20,"column":27},"end":{"row":20,"column":28},"action":"insert","lines":[";"],"id":76}],[{"start":{"row":20,"column":28},"end":{"row":20,"column":29},"action":"insert","lines":["d"],"id":77}],[{"start":{"row":20,"column":29},"end":{"row":20,"column":30},"action":"insert","lines":["i"],"id":78}],[{"start":{"row":20,"column":30},"end":{"row":20,"column":31},"action":"insert","lines":["w"],"id":79}],[{"start":{"row":20,"column":30},"end":{"row":20,"column":31},"action":"remove","lines":["w"],"id":80}],[{"start":{"row":20,"column":30},"end":{"row":20,"column":31},"action":"insert","lines":["e"],"id":81}],[{"start":{"row":20,"column":31},"end":{"row":20,"column":33},"action":"insert","lines":["()"],"id":82}],[{"start":{"row":20,"column":33},"end":{"row":20,"column":34},"action":"insert","lines":[";"],"id":83}],[{"start":{"row":19,"column":21},"end":{"row":20,"column":34},"action":"remove","lines":["","var_dump($_SESSION['code']);die();"],"id":85}],[{"start":{"row":11,"column":13},"end":{"row":11,"column":27},"action":"remove","lines":["friends,photos"],"id":86},{"start":{"row":11,"column":13},"end":{"row":11,"column":53},"action":"insert","lines":["photos,notes,pages,docs,status,questions"]}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":11,"column":53},"end":{"row":11,"column":53},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":11,"state":"php-start","mode":"ace/mode/php"}},"timestamp":1493226770803,"hash":"f98e610df876015f0eac24d5e7516a41241ff2b1"}